Wasted half a day on this.